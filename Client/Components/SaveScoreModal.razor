@using BlazorApp.Shared

<BSModal @ref="Modal" Id="saveScoreModal" IsVerticallyCentered="true">
    <Header>
        <h5 class="modal-title fw-bold">
            <i class="fas fa-save text-success me-2"></i>
            Save Your Score
        </h5>
    </Header>
    <Body>
        <div class="mb-4 text-center">
            <div class="display-6 text-primary fw-bold">@Math.Truncate(Score)</div>
            <div class="text-muted">
                @TotalClicks clicks â€¢ @(TotalClicks > 0 ? Math.Round(Score / TotalClicks, 3) : 0) efficiency
            </div>
            <p class="text-muted mb-0 mt-2">Awesome score! Enter your name to save it to the leaderboard.</p>
        </div>
        
        <div class="mb-3">
            <label for="playerName" class="form-label fw-semibold">Player Name</label>
            <input type="text" 
                   class="form-control form-control-lg" 
                   id="playerName" 
                   @bind="playerName" 
                   @onkeypress="HandleKeyPress"
                   placeholder="Enter your name"
                   maxlength="50"
                   disabled="@isSaving">
        </div>
        
        @if (!string.IsNullOrWhiteSpace(errorMessage))
        {
            <div class="alert alert-danger" role="alert">
                <i class="fas fa-exclamation-triangle me-2"></i>
                @errorMessage
            </div>
        }
        
        @if (isSaving)
        {
            <div class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Saving...</span>
                </div>
                <p class="mt-2 text-muted">Saving your score...</p>
            </div>
        }
    </Body>
    <Footer>
        <div class="hstack gap-2">
            <button type="button" 
                    class="btn btn-outline-secondary" 
                    @onclick="SkipSave"
                    disabled="@isSaving">
                Skip
            </button>
            <div class="vr"></div>
            <button type="button" 
                    class="btn btn-success ms-auto" 
                    @onclick="SaveScore"
                    disabled="@(isSaving || string.IsNullOrWhiteSpace(playerName))">
                <i class="fas fa-save me-2"></i>
                @(isSaving ? "Saving..." : "Save Score")
            </button>
        </div>
    </Footer>
</BSModal>